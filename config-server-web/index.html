<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>layui</title>
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="layui/css/layui.css" media="all">
  <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
</head>

<body>
  <div style="padding: 10px;">
    <div class="layui-row layui-col-space8">
      <div class="layui-col-xs6">
        <!-- 搜索框 -->
        <div class="leftTableToolbar">
          搜索项目：
          <div class="layui-inline">
            <input class="layui-input" name="project" id="leftTableReload" autocomplete="off">
          </div>
          <button class="layui-btn" data-type="reload">搜索</button>
          <span class=""></span>
          <button class="layui-btn layui-btn-normal" id="createNew">新增</button>
        </div>
        <!-- 左边项目环境列表-->
        <table id="profileTable" class="layui-table" lay-filter="profileTableFilter">
        </table>
      </div>
      <div class="layui-col-xs6">
          <!-- 搜索框 -->
          <div class="leftTableToolbar">
              搜索项目：
              <div class="layui-inline">
                  <input class="layui-input" name="project" id="rightTableReload" autocomplete="off">
              </div>
              <button class="layui-btn" data-type="reload">搜索</button>
              <span class=""></span>
              <button class="layui-btn layui-btn-normal" id="createProperties">新增</button>
          </div>
        <table id="propertiesTable" class="layui-table" lay-filter="right-properties">
          <!-- <th lay-data="{type:'checkbox', fixed: 'left'}"></th> -->
        </table>
      </div>
    </div>
  </div>



  <!-- 工具栏 -->
  <script type="text/html" id="leftRowToolbar">
  {{# if(d.id == -1){ }}
    <button class="layui-btn layui-btn-xs" lay-event="save">保存</button>
  {{# } else { }}
    <button class="layui-btn layui-btn-xs layui-btn-disabled" disabled=true lay-event="edit">更新</button>
    <button class="layui-btn layui-btn-danger layui-btn-xs" lay-event="copy">复制</button>
  {{# } }}
  </script>

  <script src="scripts/base.js" charset="utf-8"></script>
  <script src="scripts/api.js" charset="utf-8"></script>
  <script src="layui/layui.js" charset="utf-8"></script>
  <script src="scripts/index.js" charset="utf-8"></script>
  <!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
  <script>
    layui.use(['jquery', 'laydate', 'util', 'layer', 'table', 'form'], function ($, laydate, util, layer, table, form) {
      var table = layui.table;

      //右边表格
      var propertiesTable = table.render({
        elem: "#propertiesTable",
        url: 'http://localhost:8080/props/profile/list', //数据接口
        page: false, //开启分页
        cols: [
          [ //表头
            {
              field: 'id',
              title: 'ID',
              width: 40,
              sort: true,
              align: 'center',
              fixed: 'left'
            },
            {
              field: 'project',
              title: '项目',
              width: 120,
              edit: 'text'
            },
            {
              field: 'profile',
              title: '环境',
              width: 120,
              edit: 'text'
            },
            {
              field: 'remark',
              title: '备注',
              width: 120,
              edit: 'text'
            },
            {
              fixed: 'right',
              title: '操作',
              toolbar: '#rowToolbar',
              width: 120
            }
          ]
        ],
        parseData: baseUtil.parsedata
      });
      //监听单元格编辑
      table.on('edit(right-properties)', function (obj) {
        var value = obj.value //得到修改后的值
          ,
          data = obj.data //得到所在行所有键值
          ,
          field = obj.field; //得到字段
        layer.msg('[ID: ' + data.id + '] ' + field + ' 字段更改为：' + value);
      });
      // 新增一条记录
      $('#createNew').click(function () {
        var tableObj = propertiesTable;
        var config = tableObj.config;
        var dataTemp = table.cache.propertiesTable;
        dataTemp.push({
          id: 'new' + new Date().getTime()
        });
        propertiesTable = table.reload(config.id, {
          data: dataTemp
        });
      });
    });
  </script>

</body>

</html>